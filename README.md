# 실시간 카메라 번역 App
## 📖 목차
1. [소개](#-소개)
2. [타임라인](#-타임라인)
3. [트러블 슈팅](#-트러블-슈팅)


</br>

## 🍀 소개
카메라 작동중 실시간으로 Text를 감지하여 노란박스로 표시. 사용자는 원하는 화면을 캡쳐하고, 캡쳐된 이미지 내부의 텍스트가 자동 번역되어 기존 Text위에 표기되는 App

</br>

## ⏰ 타임라인
|날짜|내용|
|:--:|--|
| 2023-10-13 | 카메라 권한 요청 및 허가를 위한 메서드 추가 <br>AVCaptureSession을 이용한 카메라 화면 띄우는 기능 추가|
| 2023-10-17 | 텍스트 감지 기능 추가 |

</br>

## 🧨 트러블 슈팅

1️⃣ **카메라 접근 권한 거부시 재설정** <br>
-
🔒 **🧐문제점🧐** <br>
카메라 접근 권한을 거부했을 경우 다시 App을 실행 시켜도 다시 접근 권한을 물어보는게 아니라 바로 App이 종료되었습니다. 이 경우 직접 설정에 들어가 권한을 다시 허가해줘야했기 때문에 사용자입장에서 매우 불친절하다고 느껴질거라고 판단되었습니다.

🔑 **😆해결방법😆** <br>
기존에 접근 권한을 거부했을경우 현재 접근 권한이 없음을 알리고 다시 설정할거냐는 Alert을 띄우게 하였습니다. 이때 사용자가 다시 설정하려는 경우 설정창으로 바로 이동할 수 있게 UIApplication 클래스의 openSettingsURLString 프로퍼티를 이용하여 앱의 사용자 설정에 관한 딥링크 URL을 생성 및 사용하였습니다.

<br>

2️⃣ **Custom Camera** <br>
-
🔒 **🧐문제점🧐** <br>
카메라를 활성화하기 위한 방법을 찾을때 첫번째로 알게 된 것은 UIImagePickerController였습니다. 하지만 UIImagePickerController를 이용해 카메라를 켤 경우 기본적으로 이미 UI가 제공되고 Custom하게 UI를 조작해보려 해도 제가 원하는 아무것도 없는 깔끔한 화면을 구현하는데엔 제한이 있다고 판단되었습니다.

🔑 **😆해결방법😆** <br>
AVCaptureSession을 이용하여 카메라를 활성화하였고 별도의 UI를 만들어주지 않았기 때문에 제가 원하는 화면이 되었습니다.

<br>

3️⃣ **쓰고싶다 DataScannerViewController** <br>
-
🔒 **🧐문제점🧐** <br>
사실 이번 App을 만들면서 기존에 이미 아이폰 카메라 앱에 탑재된 실시간 번역 기능을 외적으로 많이 참고 하였습니다. 특히 실시간으로 텍스트를 감지 및 추적하여 감지된 영역을 따로 노란 선으로 감싸듯 표기해주는 부분을 구현해 보고 싶었는데 DataScannerViewController을 사용하면 비교적 손쉽게 구현을 할수있고 그외에도 도움이 되는 다양한 기능이 있다는 걸 알게되어 시도 해보았습니다만 제 아이폰 기기는 이상하게 해당 기능을 사용할 수 없었습니다.

🔑 **😆해결방법😆** <br>
제가 가지고 있는 아이폰 X는 A11 Bionic 칩이 탑재되어있는데 DataScannerViewController은 A12 Bionic 칩이 있어야 기능을 활용할수 있다는것을 알게 되었습니다. 하드웨어적인 문제라 포기하고 손수 만들어 보기로 결정했습니다.

<br>

4️⃣ **카메라 활성화시 텍스트 감지** <br>
-
🔒 **🧐문제점🧐** <br>
최초 의도는 텍스트를 비추기만해도 텍스트를 감지한 뒤 표시하는 것이였습니다. 하지만 공식문서를 봐도 대부분 이미지에 대한 감지 등 이미지를 기준으로 처리를 하는것이 대부분이라 어떻게 해야 할지 갈피를 잡을 수 없었습니다.

🔑 **😆해결방법😆** <br>
비디오 처리를 위해 비디오 프레임에 대해 접근할 수 있게 해주는 AVCaptureVideoDataOutput 클래스를 이용하여 (제가 이해하기로는) 프레임의 sample buffers를 받아 VNImageRequestHandler를 이용해 이미지 분석을 요청하고 처리하게 함으로써 미흡하지만 실시간으로 텍스트 감지에 성공하였습니다.
(sample buffers: CMSampleBuffer타입 = 특정 유형(오디오, 비디오, 다중화 등)의 미디어 샘플을 0개 이상 포함하는 Core Foundation 개체)

<br>

